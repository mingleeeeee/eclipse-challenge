<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ちいかわ Image Gen</title>
    <link rel="stylesheet" href="css/mask.css">
    <link rel="stylesheet" href="css/story-protocol.css">
    <link rel="stylesheet" href="css/IPregister.css">
    <script src="https://unpkg.com/konva@8.0.2/konva.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        /* Center the image and text within the container */
.token-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 10px;
}

.token-link {
    margin-left: 10px;
    font-size: 1.2em;
    color: #000; /* Adjust the color if necessary */
    text-decoration: none;
}

.token-link:hover {
    text-decoration: underline;
}

    </style>
</head>
<body>
    <!-- url button to publish-->
    <a id="backButton" href="publish">See NFT lists!</a>
    <!-- Container for the wallet login button in the right upper corner -->
    <div class="login-container">
        <button class="metamask-button" id="connectButton">
            <img src="image/metamask.png" alt="metamask logo" width="20px" style="margin-right: 5px;" /> Connect wallet
        </button>
        <div id="walletID">Your wallet is not connected yet.</div>
      
    </div>
    <div></div>
    <div class="container" style="margin-top: 100px;">
        <h1>ちいかわ</h1>
    </div>

    <div class="container" style="margin-top: 20px;"> 
        <div id="imageContainer">
            <img src="image/chiikawa_rgba.png" id="sourceImage" alt="Image">
            <canvas id="canvasMask" width="248" height="248"></canvas>
        </div>
    </div>

    <div class="container" style="margin-top: 10px;">
        <button onclick="confirmMask()">Confirm Mask Selection</button>    
        <button id="reloadButton" style="margin-left: 10px;">Reload</button>  
    </div>

    <div class="container" style="text-align: center;">
        <h4>
            Left-click three times on the canvas and drag to start creating a mask.<br>
            Use mouse wheel to change the circle size.<br>
            Confirm the mask selection and type in prompt to generate a new image.<br>
            Enjoy creating pics!

            <div class="token-container" style="visibility: hidden;" id="Neon-button">
                <img src="image/neon.png" alt="neon logo" width="60px" style="margin-right: 5px;" /> 
                <a href="https://neonfaucet.org/" target="_blank" class="token-link">Get Free Token ♡</a>
            </div>
        </h4>
       
    </div>

    <div class="container" style="margin-top: 0px;">
        <textarea id="textBox" placeholder="Enter text here..."></textarea>
    </div>

    <div class="container" style="margin-top: 10px;">
        <button id="generateButton">Generate</button>
    </div>

    <div class="container" style="margin-top: 20px;">
        <button id="mintButton" disabled>Mint your NFT :D</button> <!-- The mint button that shows up after generating an image -->
    </div>

    <!-- Canvas and Mask Creation Script -->
    <script src="js/mask.js"></script>
    <script src="js/metamask.js"></script>

    <script>
        // Asynchronously set session on page load
        window.addEventListener('load', async () => {
            try {
                const response = await fetch('/setSession', { method: 'POST' });
                if (response.ok) {
                    console.log('Session variable reset successfully.');
                } else {
                    console.error('Failed to reset session variable.');
                }
            } catch (error) {
                console.error('Error setting session variable:', error);
            }
        });
    </script>
</body>
</html>
